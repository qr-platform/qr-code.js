import{A as be}from"./zbar-scan-validator-CdUmQrkV-1ijjMw23.js";var de,fe,Y,y,G,P,te,L,Re=(de=function(l,e){return de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},de(l,e)},function(l,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=l}de(l,e),l.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}),Be=function(l){function e(t,r){var s,n,i,o=this.constructor,a=l.call(this,t,r)||this;return Object.defineProperty(a,"name",{value:o.name,enumerable:!1,configurable:!0}),s=a,n=o.prototype,(i=Object.setPrototypeOf)?i(s,n):s.__proto__=n,function(c,u){u===void 0&&(u=c.constructor);var d=Error.captureStackTrace;d&&d(c,u)}(a),a}return Re(e,l),e}(Error);class V extends Be{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}V.kind="Exception";class _ extends V{static getNotFoundInstance(){return new _}}_.kind="NotFoundException",function(l){l[l.AZTEC=0]="AZTEC",l[l.CODABAR=1]="CODABAR",l[l.CODE_39=2]="CODE_39",l[l.CODE_93=3]="CODE_93",l[l.CODE_128=4]="CODE_128",l[l.DATA_MATRIX=5]="DATA_MATRIX",l[l.EAN_8=6]="EAN_8",l[l.EAN_13=7]="EAN_13",l[l.ITF=8]="ITF",l[l.MAXICODE=9]="MAXICODE",l[l.PDF_417=10]="PDF_417",l[l.QR_CODE=11]="QR_CODE",l[l.RSS_14=12]="RSS_14",l[l.RSS_EXPANDED=13]="RSS_EXPANDED",l[l.UPC_A=14]="UPC_A",l[l.UPC_E=15]="UPC_E",l[l.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(fe||(fe={}));class N extends V{}N.kind="IllegalArgumentException";class ye extends V{}ye.kind="IndexOutOfBoundsException";class me extends ye{constructor(e,t){super(t),this.index=e,this.message=t}}me.kind="ArrayIndexOutOfBoundsException";class q{static arraycopy(e,t,r,s,n){if(e===r&&t<s)for(s+=n-1,t+=n-1;n--;)r[s--]=e[t--];else for(;n--;)r[s++]=e[t++]}static currentTimeMillis(){return Date.now()}}class ${static fill(e,t){for(let r=0,s=e.length;r<s;r++)e[r]=t}static fillWithin(e,t,r,s){$.rangeCheck(e.length,t,r);for(let n=t;n<r;n++)e[n]=s}static rangeCheck(e,t,r){if(t>r)throw new N("fromIndex("+t+") > toIndex("+r+")");if(t<0)throw new me(t);if(r>e)throw new me(r)}static asList(...e){return e}static create(e,t,r){return Array.from({length:e}).map(s=>Array.from({length:t}).fill(r))}static createInt32Array(e,t,r){return Array.from({length:e}).map(s=>Int32Array.from({length:t}).fill(r))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let r=0,s=e.length;r<s;r++)if(e[r]!==t[r])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const r of e)t=31*t+r;return t}static fillUint8Array(e,t){for(let r=0;r!==e.length;r++)e[r]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const r=new Uint8Array(t);return r.set(e),r}return e.slice(0,t)}static copyOfRange(e,t,r){const s=r-t,n=new Int32Array(s);return q.arraycopy(e,t,n,0,s),n}static binarySearch(e,t,r){r===void 0&&(r=$.numberComparator);let s=0,n=e.length-1;for(;s<=n;){const i=n+s>>1,o=r(t,e[i]);if(o>0)s=i+1;else{if(!(o<0))return i;n=i-1}}return-s-1}static numberComparator(e,t){return e-t}}(function(l){l[l.OTHER=0]="OTHER",l[l.PURE_BARCODE=1]="PURE_BARCODE",l[l.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",l[l.TRY_HARDER=3]="TRY_HARDER",l[l.CHARACTER_SET=4]="CHARACTER_SET",l[l.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",l[l.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",l[l.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",l[l.ASSUME_GS1=8]="ASSUME_GS1",l[l.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",l[l.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",l[l.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(Y||(Y={}));class O extends V{static getFormatInstance(){return new O}}O.kind="FormatException",function(l){l[l.Cp437=0]="Cp437",l[l.ISO8859_1=1]="ISO8859_1",l[l.ISO8859_2=2]="ISO8859_2",l[l.ISO8859_3=3]="ISO8859_3",l[l.ISO8859_4=4]="ISO8859_4",l[l.ISO8859_5=5]="ISO8859_5",l[l.ISO8859_6=6]="ISO8859_6",l[l.ISO8859_7=7]="ISO8859_7",l[l.ISO8859_8=8]="ISO8859_8",l[l.ISO8859_9=9]="ISO8859_9",l[l.ISO8859_10=10]="ISO8859_10",l[l.ISO8859_11=11]="ISO8859_11",l[l.ISO8859_13=12]="ISO8859_13",l[l.ISO8859_14=13]="ISO8859_14",l[l.ISO8859_15=14]="ISO8859_15",l[l.ISO8859_16=15]="ISO8859_16",l[l.SJIS=16]="SJIS",l[l.Cp1250=17]="Cp1250",l[l.Cp1251=18]="Cp1251",l[l.Cp1252=19]="Cp1252",l[l.Cp1256=20]="Cp1256",l[l.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",l[l.UTF8=22]="UTF8",l[l.ASCII=23]="ASCII",l[l.Big5=24]="Big5",l[l.GB18030=25]="GB18030",l[l.EUC_KR=26]="EUC_KR"}(y||(y={}));class I{constructor(e,t,r,...s){this.valueIdentifier=e,this.name=r,this.values=typeof t=="number"?Int32Array.from([t]):t,this.otherEncodingNames=s,I.VALUE_IDENTIFIER_TO_ECI.set(e,this),I.NAME_TO_ECI.set(r,this);const n=this.values;for(let i=0,o=n.length;i!==o;i++){const a=n[i];I.VALUES_TO_ECI.set(a,this)}for(const i of s)I.NAME_TO_ECI.set(i,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new O("incorect value");const t=I.VALUES_TO_ECI.get(e);if(t===void 0)throw new O("incorect value");return t}static getCharacterSetECIByName(e){const t=I.NAME_TO_ECI.get(e);if(t===void 0)throw new O("incorect value");return t}equals(e){if(!(e instanceof I))return!1;const t=e;return this.getName()===t.getName()}}I.VALUE_IDENTIFIER_TO_ECI=new Map,I.VALUES_TO_ECI=new Map,I.NAME_TO_ECI=new Map,I.Cp437=new I(y.Cp437,Int32Array.from([0,2]),"Cp437"),I.ISO8859_1=new I(y.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),I.ISO8859_2=new I(y.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),I.ISO8859_3=new I(y.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),I.ISO8859_4=new I(y.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),I.ISO8859_5=new I(y.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),I.ISO8859_6=new I(y.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),I.ISO8859_7=new I(y.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),I.ISO8859_8=new I(y.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),I.ISO8859_9=new I(y.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),I.ISO8859_10=new I(y.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),I.ISO8859_11=new I(y.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),I.ISO8859_13=new I(y.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),I.ISO8859_14=new I(y.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),I.ISO8859_15=new I(y.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),I.ISO8859_16=new I(y.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),I.SJIS=new I(y.SJIS,20,"SJIS","Shift_JIS"),I.Cp1250=new I(y.Cp1250,21,"Cp1250","windows-1250"),I.Cp1251=new I(y.Cp1251,22,"Cp1251","windows-1251"),I.Cp1252=new I(y.Cp1252,23,"Cp1252","windows-1252"),I.Cp1256=new I(y.Cp1256,24,"Cp1256","windows-1256"),I.UnicodeBigUnmarked=new I(y.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),I.UTF8=new I(y.UTF8,26,"UTF8","UTF-8"),I.ASCII=new I(y.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),I.Big5=new I(y.Big5,28,"Big5"),I.GB18030=new I(y.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),I.EUC_KR=new I(y.EUC_KR,30,"EUC_KR","EUC-KR");class ae extends V{}ae.kind="UnsupportedOperationException";class Q{static decode(e,t){const r=this.encodingName(t);return this.customDecoder?this.customDecoder(e,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(e,r):new TextDecoder(r).decode(e)}static shouldDecodeOnFallback(e){return!Q.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const r=this.encodingName(t);return this.customEncoder?this.customEncoder(e,r):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof I?e:I.getCharacterSetECIByName(e)}static decodeFallback(e,t){const r=this.encodingCharacterSet(t);if(Q.isDecodeFallbackSupported(r)){let s="";for(let n=0,i=e.length;n<i;n++){let o=e[n].toString(16);o.length<2&&(o="0"+o),s+="%"+o}return decodeURIComponent(s)}if(r.equals(I.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new ae(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(I.UTF8)||e.equals(I.ISO8859_1)||e.equals(I.ASCII)}static encodeFallback(e){const t=btoa(unescape(encodeURIComponent(e))).split(""),r=[];for(let s=0;s<t.length;s++)r.push(t[s].charCodeAt(0));return new Uint8Array(r)}}class B{static castAsNonUtf8Char(e,t=null){const r=t?t.getName():this.ISO88591;return Q.decode(new Uint8Array([e]),r)}static guessEncoding(e,t){if(t!=null&&t.get(Y.CHARACTER_SET)!==void 0)return t.get(Y.CHARACTER_SET).toString();const r=e.length;let s=!0,n=!0,i=!0,o=0,a=0,c=0,u=0,d=0,f=0,g=0,m=0,C=0,A=0,M=0;const U=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let b=0;b<r&&(s||n||i);b++){const T=255&e[b];i&&(o>0?128&T?o--:i=!1:128&T&&(64&T?(o++,32&T?(o++,16&T?(o++,8&T?i=!1:u++):c++):a++):i=!1)),s&&(T>127&&T<160?s=!1:T>159&&(T<192||T===215||T===247)&&M++),n&&(d>0?T<64||T===127||T>252?n=!1:d--:T===128||T===160||T>239?n=!1:T>160&&T<224?(f++,m=0,g++,g>C&&(C=g)):T>127?(d++,g=0,m++,m>A&&(A=m)):(g=0,m=0))}return i&&o>0&&(i=!1),n&&d>0&&(n=!1),i&&(U||a+c+u>0)?B.UTF8:n&&(B.ASSUME_SHIFT_JIS||C>=3||A>=3)?B.SHIFT_JIS:s&&n?C===2&&f===2||10*M>=r?B.SHIFT_JIS:B.ISO88591:s?B.ISO88591:n?B.SHIFT_JIS:i?B.UTF8:B.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let r=-1;return e.replace(/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g,function(s,n,i,o,a,c){if(s==="%%")return"%";if(t[++r]===void 0)return;s=o?parseInt(o.substr(1)):void 0;let u,d=a?parseInt(a.substr(1)):void 0;switch(c){case"s":u=t[r];break;case"c":u=t[r][0];break;case"f":u=parseFloat(t[r]).toFixed(s);break;case"p":u=parseFloat(t[r]).toPrecision(s);break;case"e":u=parseFloat(t[r]).toExponential(s);break;case"x":u=parseInt(t[r]).toString(d||16);break;case"d":u=parseFloat(parseInt(t[r],d||10).toPrecision(s)).toFixed(0)}u=typeof u=="object"?JSON.stringify(u):(+u).toString(d);let f=parseInt(i),g=i&&i[0]+""=="0"?"0":" ";for(;u.length<f;)u=n!==void 0?u+g:g+u;return u})}static getBytes(e,t){return Q.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}B.SHIFT_JIS=I.SJIS.getName(),B.GB2312="GB2312",B.ISO88591=I.ISO8859_1.getName(),B.EUC_JP="EUC_JP",B.UTF8=I.UTF8.getName(),B.PLATFORM_DEFAULT_ENCODING=B.UTF8,B.ASSUME_SHIFT_JIS=!1;class Se{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=B.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,r){for(let s=t;t<t+r;s++)this.append(e[s]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)}}class ne{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let r=31;return t=e<<16,t!==0&&(r-=16,e=t),t=e<<8,t!==0&&(r-=8,e=t),t=e<<4,t!==0&&(r-=4,e=t),t=e<<2,t!==0&&(r-=2,e=t),r-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return!(e>>>16)&&(t+=16,e<<=16),!(e>>>24)&&(t+=8,e<<=8),!(e>>>28)&&(t+=4,e<<=4),!(e>>>30)&&(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135,e+=e>>>8,63&(e+=e>>>16)}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}ne.MIN_VALUE_32_BITS=-2147483648,ne.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Z{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,this.bits=t??Z.makeArray(e))}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>32*this.bits.length){const t=Z.makeArray(e);q.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return!!(this.bits[Math.floor(e/32)]&1<<(31&e))}set(e){this.bits[Math.floor(e/32)]|=1<<(31&e)}flip(e){this.bits[Math.floor(e/32)]^=1<<(31&e)}getNextSet(e){const t=this.size;if(e>=t)return t;const r=this.bits;let s=Math.floor(e/32),n=r[s];n&=~((1<<(31&e))-1);const i=r.length;for(;n===0;){if(++s===i)return t;n=r[s]}const o=32*s+ne.numberOfTrailingZeros(n);return o>t?t:o}getNextUnset(e){const t=this.size;if(e>=t)return t;const r=this.bits;let s=Math.floor(e/32),n=~r[s];n&=~((1<<(31&e))-1);const i=r.length;for(;n===0;){if(++s===i)return t;n=~r[s]}const o=32*s+ne.numberOfTrailingZeros(n);return o>t?t:o}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new N;if(t===e)return;t--;const r=Math.floor(e/32),s=Math.floor(t/32),n=this.bits;for(let i=r;i<=s;i++){const o=(2<<(i<s?31:31&t))-(1<<(i>r?0:31&e));n[i]|=o}}clear(){const e=this.bits.length,t=this.bits;for(let r=0;r<e;r++)t[r]=0}isRange(e,t,r){if(t<e||e<0||t>this.size)throw new N;if(t===e)return!0;t--;const s=Math.floor(e/32),n=Math.floor(t/32),i=this.bits;for(let o=s;o<=n;o++){const a=(2<<(o<n?31:31&t))-(1<<(o>s?0:31&e))&4294967295;if((i[o]&a)!==(r?a:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(e,t){if(t<0||t>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let r=t;r>0;r--)this.appendBit((e>>r-1&1)==1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let r=0;r<t;r++)this.appendBit(e.get(r))}xor(e){if(this.size!==e.size)throw new N("Sizes don't match");const t=this.bits;for(let r=0,s=t.length;r<s;r++)t[r]^=e.bits[r]}toBytes(e,t,r,s){for(let n=0;n<s;n++){let i=0;for(let o=0;o<8;o++)this.get(e)&&(i|=1<<7-o),e++;t[r+n]=i}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),r=t+1,s=this.bits;for(let n=0;n<r;n++){let i=s[n];i=i>>1&1431655765|(1431655765&i)<<1,i=i>>2&858993459|(858993459&i)<<2,i=i>>4&252645135|(252645135&i)<<4,i=i>>8&16711935|(16711935&i)<<8,i=i>>16&65535|(65535&i)<<16,e[t-n]=i}if(this.size!==32*r){const n=32*r-this.size;let i=e[0]>>>n;for(let o=1;o<r;o++){const a=e[o];i|=a<<32-n,e[o-1]=i,i=a>>>n}e[r-1]=i}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof Z))return!1;const t=e;return this.size===t.size&&$.equals(this.bits,t.bits)}hashCode(){return 31*this.size+$.hashCode(this.bits)}toString(){let e="";for(let t=0,r=this.size;t<r;t++)7&t||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new Z(this.size,this.bits.slice())}toArray(){let e=[];for(let t=0,r=this.size;t<r;t++)e.push(this.get(t));return e}}class K{constructor(e,t,r,s){if(this.width=e,this.height=t,this.rowSize=r,this.bits=s,t==null&&(t=e),this.height=t,e<1||t<1)throw new N("Both dimensions must be greater than 0");r==null&&(r=(e+31)/32|0),this.rowSize=r,s==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,r=e[0].length,s=new K(r,t);for(let n=0;n<t;n++){const i=e[n];for(let o=0;o<r;o++)i[o]&&s.set(o,n)}return s}static parseFromString(e,t,r){if(e===null)throw new N("stringRepresentation cannot be null");const s=new Array(e.length);let n=0,i=0,o=-1,a=0,c=0;for(;c<e.length;){const d=e.charAt(c);if(d===`
`||d==="\r"){if(n>i){if(o===-1)o=n-i;else if(n-i!==o)throw new N("row lengths do not match");i=n,a++}c++}else if(e.substring(c,c+t.length)===t)c+=t.length,s[n++]=!0;else{if(e.substring(c,c+r.length)!==r)throw new N("illegal character encountered: "+e.substring(c));c+=r.length,s[n++]=!1}}if(n>i){if(o===-1)o=n-i;else if(n-i!==o)throw new N("row lengths do not match");a++}const u=new K(o,a);for(let d=0;d<n;d++)s[d]&&u.set(d%o,Math.floor(d/o));return u}get(e,t){const r=t*this.rowSize+(e>>5);return!!(this.bits[r]>>>(31&e)&1)}set(e,t){const r=t*this.rowSize+(e>>5);this.bits[r]|=1<<(31&e)}unset(e,t){const r=t*this.rowSize+(e>>5);this.bits[r]&=~(1<<(31&e))}flip(e,t){const r=t*this.rowSize+(e>>5);this.bits[r]^=1<<(31&e)}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new N("input matrix dimensions do not match");const t=new Z(1+(this.width>>5)),r=this.rowSize,s=this.bits;for(let n=0,i=this.height;n<i;n++){const o=n*r,a=e.getRow(n,t).getBitArray();for(let c=0;c<r;c++)s[o+c]^=a[c]}}clear(){const e=this.bits,t=e.length;for(let r=0;r<t;r++)e[r]=0}setRegion(e,t,r,s){if(t<0||e<0)throw new N("Left and top must be nonnegative");if(s<1||r<1)throw new N("Height and width must be at least 1");const n=e+r,i=t+s;if(i>this.height||n>this.width)throw new N("The region must fit inside the matrix");const o=this.rowSize,a=this.bits;for(let c=t;c<i;c++){const u=c*o;for(let d=e;d<n;d++)a[u+(d>>5)]|=1<<(31&d)}}getRow(e,t){t==null||t.getSize()<this.width?t=new Z(this.width):t.clear();const r=this.rowSize,s=this.bits,n=e*r;for(let i=0;i<r;i++)t.setBulk(32*i,s[n+i]);return t}setRow(e,t){q.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let r=new Z(e),s=new Z(e);for(let n=0,i=Math.floor((t+1)/2);n<i;n++)r=this.getRow(n,r),s=this.getRow(t-1-n,s),r.reverse(),s.reverse(),this.setRow(n,s),this.setRow(t-1-n,r)}getEnclosingRectangle(){const e=this.width,t=this.height,r=this.rowSize,s=this.bits;let n=e,i=t,o=-1,a=-1;for(let c=0;c<t;c++)for(let u=0;u<r;u++){const d=s[c*r+u];if(d!==0){if(c<i&&(i=c),c>a&&(a=c),32*u<n){let f=0;for(;!(d<<31-f>>>0);)f++;32*u+f<n&&(n=32*u+f)}if(32*u+31>o){let f=31;for(;!(d>>>f);)f--;32*u+f>o&&(o=32*u+f)}}}return o<n||a<i?null:Int32Array.from([n,i,o-n+1,a-i+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let r=0;for(;r<t.length&&t[r]===0;)r++;if(r===t.length)return null;const s=Math.floor(r/e);let n=r%e<<5;const i=t[r];let o=0;for(;!(i<<31-o>>>0);)o++;return n+=o,Int32Array.from([n,s])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let r=t.length-1;for(;r>=0&&t[r]===0;)r--;if(r<0)return null;const s=Math.floor(r/e);let n=r%e<<5;const i=t[r];let o=31;for(;!(i>>>o);)o--;return n+=o,Int32Array.from([n,s])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof K))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&$.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.height,e=31*e+this.rowSize,e=31*e+$.hashCode(this.bits),e}toString(e="X ",t="  ",r=`
`){return this.buildToString(e,t,r)}buildToString(e,t,r){const s=new Se,n=this.height,i=this.width;if(n===void 0||i===void 0)throw new Error("Matrix dimensions are undefined");for(let o=0;o<n;o++){for(let a=0;a<i;a++)s.append(this.get(a,o)?e:t);s.append(r)}return s.toString()}clone(){return new K(this.width,this.height,this.rowSize,this.bits.slice())}}class Oe{constructor(e=null,t,r=t==null?0:8*t.length,s,n,i=q.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=r,this.resultPoints=s,this.format=n,this.timestamp=i,this.text=e,this.rawBytes=t,this.numBits=r??(t==null?0:8*t.length),this.resultPoints=s,this.format=n,this.resultMetadata=new Map,this.timestamp=i??q.currentTimeMillis()}getText(){return this.text?this.text:null}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const r=new Array(t.length+e.length);q.arraycopy(t,0,r,0,t.length),q.arraycopy(e,0,r,t.length,e.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text===null?this.resultPoints.toString():this.text}}(function(l){l[l.OTHER=0]="OTHER",l[l.ORIENTATION=1]="ORIENTATION",l[l.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",l[l.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",l[l.ISSUE_NUMBER=4]="ISSUE_NUMBER",l[l.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",l[l.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",l[l.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",l[l.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",l[l.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",l[l.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(G||(G={}));class we extends V{static getChecksumInstance(){return new we}}we.kind="ChecksumException";class Te extends V{}Te.kind="ArithmeticException";class se{exp(e){return this.expTable[e]}log(e){if(e===0)throw new N;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class X{constructor(e,t){if(t.length===0)throw new N;this.field=e;const r=t.length;if(r>1&&t[0]===0){let s=1;for(;s<r&&t[s]===0;)s++;s===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-s),q.arraycopy(t,s,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let r;if(e===1){r=0;for(let i=0,o=t.length;i!==o;i++){const a=t[i];r=se.addOrSubtract(r,a)}return r}r=t[0];const s=t.length,n=this.field;for(let i=1;i<s;i++)r=se.addOrSubtract(n.multiply(e,r),t[i]);return r}addOrSubtract(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){const i=t;t=r,r=i}let s=new Int32Array(r.length);const n=r.length-t.length;q.arraycopy(r,0,s,0,n);for(let i=n;i<r.length;i++)s[i]=se.addOrSubtract(t[i-n],r[i]);return new X(this.field,s)}multiply(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,r=t.length,s=e.coefficients,n=s.length,i=new Int32Array(r+n-1),o=this.field;for(let a=0;a<r;a++){const c=t[a];for(let u=0;u<n;u++)i[a+u]=se.addOrSubtract(i[a+u],o.multiply(c,s[u]))}return new X(o,i)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,r=this.field,s=new Int32Array(t),n=this.coefficients;for(let i=0;i<t;i++)s[i]=r.multiply(n[i],e);return new X(r,s)}multiplyByMonomial(e,t){if(e<0)throw new N;if(t===0)return this.field.getZero();const r=this.coefficients,s=r.length,n=new Int32Array(s+e),i=this.field;for(let o=0;o<s;o++)n[o]=i.multiply(r[o],t);return new X(i,n)}divide(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new N("Divide by 0");const t=this.field;let r=t.getZero(),s=this;const n=e.getCoefficient(e.getDegree()),i=t.inverse(n);for(;s.getDegree()>=e.getDegree()&&!s.isZero();){const o=s.getDegree()-e.getDegree(),a=t.multiply(s.getCoefficient(s.getDegree()),i),c=e.multiplyByMonomial(o,a),u=t.buildMonomial(o,a);r=r.addOrSubtract(u),s=s.addOrSubtract(c)}return[r,s]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);if(r!==0){if(r<0?(e+=" - ",r=-r):e.length>0&&(e+=" + "),t===0||r!==1){const s=this.field.log(r);s===0?e+="1":s===1?e+="a":(e+="a^",e+=s)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class v extends se{constructor(e,t,r){super(),this.primitive=e,this.size=t,this.generatorBase=r;const s=new Int32Array(t);let n=1;for(let o=0;o<t;o++)s[o]=n,n*=2,n>=t&&(n^=e,n&=t-1);this.expTable=s;const i=new Int32Array(t);for(let o=0;o<t-1;o++)i[s[o]]=o;this.logTable=i,this.zero=new X(this,Int32Array.from([0])),this.one=new X(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new N;if(t===0)return this.zero;const r=new Int32Array(e+1);return r[0]=t,new X(this,r)}inverse(e){if(e===0)throw new Te;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+ne.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}v.AZTEC_DATA_12=new v(4201,4096,1),v.AZTEC_DATA_10=new v(1033,1024,1),v.AZTEC_DATA_6=new v(67,64,1),v.AZTEC_PARAM=new v(19,16,1),v.QR_CODE_FIELD_256=new v(285,256,0),v.DATA_MATRIX_FIELD_256=new v(301,256,1),v.AZTEC_DATA_8=v.DATA_MATRIX_FIELD_256,v.MAXICODE_FIELD_64=v.AZTEC_DATA_6;class _e extends V{}_e.kind="IllegalStateException";class ie extends V{}ie.kind="ReedSolomonException";class De{constructor(e){this.field=e}decode(e,t){const r=this.field,s=new X(r,e),n=new Int32Array(t);let i=!0;for(let g=0;g<t;g++){const m=s.evaluateAt(r.exp(g+r.getGeneratorBase()));n[n.length-1-g]=m,m!==0&&(i=!1)}if(i)return;const o=new X(r,n),a=this.runEuclideanAlgorithm(r.buildMonomial(t,1),o,t),c=a[0],u=a[1],d=this.findErrorLocations(c),f=this.findErrorMagnitudes(u,d);for(let g=0;g<d.length;g++){const m=e.length-1-r.log(d[g]);if(m<0)throw new ie("Bad error location");e[m]=v.addOrSubtract(e[m],f[g])}}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){const d=e;e=t,t=d}const s=this.field;let n=e,i=t,o=s.getZero(),a=s.getOne();for(;i.getDegree()>=(r/2|0);){let d=n,f=o;if(n=i,o=a,n.isZero())throw new ie("r_{i-1} was zero");i=d;let g=s.getZero();const m=n.getCoefficient(n.getDegree()),C=s.inverse(m);for(;i.getDegree()>=n.getDegree()&&!i.isZero();){const A=i.getDegree()-n.getDegree(),M=s.multiply(i.getCoefficient(i.getDegree()),C);g=g.addOrSubtract(s.buildMonomial(A,M)),i=i.addOrSubtract(n.multiplyByMonomial(A,M))}if(a=g.multiply(o).addOrSubtract(f),i.getDegree()>=n.getDegree())throw new _e("Division algorithm failed to reduce polynomial?")}const c=a.getCoefficient(0);if(c===0)throw new ie("sigmaTilde(0) was zero");const u=s.inverse(c);return[a.multiplyScalar(u),i.multiplyScalar(u)]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const r=new Int32Array(t);let s=0;const n=this.field;for(let i=1;i<n.getSize()&&s<t;i++)e.evaluateAt(i)===0&&(r[s]=n.inverse(i),s++);if(s!==t)throw new ie("Error locator degree does not match number of roots");return r}findErrorMagnitudes(e,t){const r=t.length,s=new Int32Array(r),n=this.field;for(let i=0;i<r;i++){const o=n.inverse(t[i]);let a=1;for(let c=0;c<r;c++)if(i!==c){const u=n.multiply(t[c],o),d=1&u?-2&u:1|u;a=n.multiply(a,d)}s[i]=n.multiply(e.evaluateAt(o),n.inverse(a)),n.getGeneratorBase()!==0&&(s[i]=n.multiply(s[i],o))}return s}}(function(l){l[l.DATA_MASK_000=0]="DATA_MASK_000",l[l.DATA_MASK_001=1]="DATA_MASK_001",l[l.DATA_MASK_010=2]="DATA_MASK_010",l[l.DATA_MASK_011=3]="DATA_MASK_011",l[l.DATA_MASK_100=4]="DATA_MASK_100",l[l.DATA_MASK_101=5]="DATA_MASK_101",l[l.DATA_MASK_110=6]="DATA_MASK_110",l[l.DATA_MASK_111=7]="DATA_MASK_111"})(P||(P={}));class z{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let r=0;r<t;r++)for(let s=0;s<t;s++)this.isMasked(r,s)&&e.flip(s,r)}}z.values=new Map([[P.DATA_MASK_000,new z(P.DATA_MASK_000,(l,e)=>!(l+e&1))],[P.DATA_MASK_001,new z(P.DATA_MASK_001,(l,e)=>!(1&l))],[P.DATA_MASK_010,new z(P.DATA_MASK_010,(l,e)=>e%3==0)],[P.DATA_MASK_011,new z(P.DATA_MASK_011,(l,e)=>(l+e)%3==0)],[P.DATA_MASK_100,new z(P.DATA_MASK_100,(l,e)=>!(Math.floor(l/2)+Math.floor(e/3)&1))],[P.DATA_MASK_101,new z(P.DATA_MASK_101,(l,e)=>l*e%6==0)],[P.DATA_MASK_110,new z(P.DATA_MASK_110,(l,e)=>l*e%6<3)],[P.DATA_MASK_111,new z(P.DATA_MASK_111,(l,e)=>!(l+e+l*e%3&1))]]);class J extends V{}J.kind="ArgumentException",function(l){l[l.L=0]="L",l[l.M=1]="M",l[l.Q=2]="Q",l[l.H=3]="H"}(te||(te={}));class D{constructor(e,t,r){this.value=e,this.stringValue=t,this.bits=r,D.FOR_BITS.set(r,this),D.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return D.L;case"M":return D.M;case"Q":return D.Q;case"H":return D.H;default:throw new J(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof D))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=D.FOR_BITS.size)throw new N;return D.FOR_BITS.get(e)}}D.FOR_BITS=new Map,D.FOR_VALUE=new Map,D.L=new D(te.L,"L",1),D.M=new D(te.M,"M",0),D.Q=new D(te.Q,"Q",3),D.H=new D(te.H,"H",2);class x{constructor(e){this.errorCorrectionLevel=D.forBits(e>>3&3),this.dataMask=7&e}static numBitsDiffering(e,t){return ne.bitCount(e^t)}static decodeFormatInformation(e,t){const r=x.doDecodeFormatInformation(e,t);return r!==null?r:x.doDecodeFormatInformation(e^x.FORMAT_INFO_MASK_QR,t^x.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let r=Number.MAX_SAFE_INTEGER,s=0;for(const n of x.FORMAT_INFO_DECODE_LOOKUP){const i=n[0];if(i===e||i===t)return new x(n[1]);let o=x.numBitsDiffering(e,i);o<r&&(s=n[1],r=o),e!==t&&(o=x.numBitsDiffering(t,i),o<r&&(s=n[1],r=o))}return r<=3?new x(s):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof x))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}x.FORMAT_INFO_MASK_QR=21522,x.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class h{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class w{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const r of t)e+=r.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class S{constructor(e,t,...r){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=r;let s=0;const n=r[0].getECCodewordsPerBlock(),i=r[0].getECBlocks();for(const o of i)s+=o.getCount()*(o.getDataCodewords()+n);this.totalCodewords=s}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!=1)throw new O;try{return this.getVersionForNumber((e-17)/4)}catch{throw new O}}static getVersionForNumber(e){if(e<1||e>40)throw new N;return S.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,r=0;for(let s=0;s<S.VERSION_DECODE_INFO.length;s++){const n=S.VERSION_DECODE_INFO[s];if(n===e)return S.getVersionForNumber(s+7);const i=x.numBitsDiffering(e,n);i<t&&(r=s+7,t=i)}return t<=3?S.getVersionForNumber(r):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new K(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const r=this.alignmentPatternCenters.length;for(let s=0;s<r;s++){const n=this.alignmentPatternCenters[s]-2;for(let i=0;i<r;i++)s===0&&(i===0||i===r-1)||s===r-1&&i===0||t.setRegion(this.alignmentPatternCenters[i]-2,n,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}S.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),S.VERSIONS=[new S(1,new Int32Array(0),new w(7,new h(1,19)),new w(10,new h(1,16)),new w(13,new h(1,13)),new w(17,new h(1,9))),new S(2,Int32Array.from([6,18]),new w(10,new h(1,34)),new w(16,new h(1,28)),new w(22,new h(1,22)),new w(28,new h(1,16))),new S(3,Int32Array.from([6,22]),new w(15,new h(1,55)),new w(26,new h(1,44)),new w(18,new h(2,17)),new w(22,new h(2,13))),new S(4,Int32Array.from([6,26]),new w(20,new h(1,80)),new w(18,new h(2,32)),new w(26,new h(2,24)),new w(16,new h(4,9))),new S(5,Int32Array.from([6,30]),new w(26,new h(1,108)),new w(24,new h(2,43)),new w(18,new h(2,15),new h(2,16)),new w(22,new h(2,11),new h(2,12))),new S(6,Int32Array.from([6,34]),new w(18,new h(2,68)),new w(16,new h(4,27)),new w(24,new h(4,19)),new w(28,new h(4,15))),new S(7,Int32Array.from([6,22,38]),new w(20,new h(2,78)),new w(18,new h(4,31)),new w(18,new h(2,14),new h(4,15)),new w(26,new h(4,13),new h(1,14))),new S(8,Int32Array.from([6,24,42]),new w(24,new h(2,97)),new w(22,new h(2,38),new h(2,39)),new w(22,new h(4,18),new h(2,19)),new w(26,new h(4,14),new h(2,15))),new S(9,Int32Array.from([6,26,46]),new w(30,new h(2,116)),new w(22,new h(3,36),new h(2,37)),new w(20,new h(4,16),new h(4,17)),new w(24,new h(4,12),new h(4,13))),new S(10,Int32Array.from([6,28,50]),new w(18,new h(2,68),new h(2,69)),new w(26,new h(4,43),new h(1,44)),new w(24,new h(6,19),new h(2,20)),new w(28,new h(6,15),new h(2,16))),new S(11,Int32Array.from([6,30,54]),new w(20,new h(4,81)),new w(30,new h(1,50),new h(4,51)),new w(28,new h(4,22),new h(4,23)),new w(24,new h(3,12),new h(8,13))),new S(12,Int32Array.from([6,32,58]),new w(24,new h(2,92),new h(2,93)),new w(22,new h(6,36),new h(2,37)),new w(26,new h(4,20),new h(6,21)),new w(28,new h(7,14),new h(4,15))),new S(13,Int32Array.from([6,34,62]),new w(26,new h(4,107)),new w(22,new h(8,37),new h(1,38)),new w(24,new h(8,20),new h(4,21)),new w(22,new h(12,11),new h(4,12))),new S(14,Int32Array.from([6,26,46,66]),new w(30,new h(3,115),new h(1,116)),new w(24,new h(4,40),new h(5,41)),new w(20,new h(11,16),new h(5,17)),new w(24,new h(11,12),new h(5,13))),new S(15,Int32Array.from([6,26,48,70]),new w(22,new h(5,87),new h(1,88)),new w(24,new h(5,41),new h(5,42)),new w(30,new h(5,24),new h(7,25)),new w(24,new h(11,12),new h(7,13))),new S(16,Int32Array.from([6,26,50,74]),new w(24,new h(5,98),new h(1,99)),new w(28,new h(7,45),new h(3,46)),new w(24,new h(15,19),new h(2,20)),new w(30,new h(3,15),new h(13,16))),new S(17,Int32Array.from([6,30,54,78]),new w(28,new h(1,107),new h(5,108)),new w(28,new h(10,46),new h(1,47)),new w(28,new h(1,22),new h(15,23)),new w(28,new h(2,14),new h(17,15))),new S(18,Int32Array.from([6,30,56,82]),new w(30,new h(5,120),new h(1,121)),new w(26,new h(9,43),new h(4,44)),new w(28,new h(17,22),new h(1,23)),new w(28,new h(2,14),new h(19,15))),new S(19,Int32Array.from([6,30,58,86]),new w(28,new h(3,113),new h(4,114)),new w(26,new h(3,44),new h(11,45)),new w(26,new h(17,21),new h(4,22)),new w(26,new h(9,13),new h(16,14))),new S(20,Int32Array.from([6,34,62,90]),new w(28,new h(3,107),new h(5,108)),new w(26,new h(3,41),new h(13,42)),new w(30,new h(15,24),new h(5,25)),new w(28,new h(15,15),new h(10,16))),new S(21,Int32Array.from([6,28,50,72,94]),new w(28,new h(4,116),new h(4,117)),new w(26,new h(17,42)),new w(28,new h(17,22),new h(6,23)),new w(30,new h(19,16),new h(6,17))),new S(22,Int32Array.from([6,26,50,74,98]),new w(28,new h(2,111),new h(7,112)),new w(28,new h(17,46)),new w(30,new h(7,24),new h(16,25)),new w(24,new h(34,13))),new S(23,Int32Array.from([6,30,54,78,102]),new w(30,new h(4,121),new h(5,122)),new w(28,new h(4,47),new h(14,48)),new w(30,new h(11,24),new h(14,25)),new w(30,new h(16,15),new h(14,16))),new S(24,Int32Array.from([6,28,54,80,106]),new w(30,new h(6,117),new h(4,118)),new w(28,new h(6,45),new h(14,46)),new w(30,new h(11,24),new h(16,25)),new w(30,new h(30,16),new h(2,17))),new S(25,Int32Array.from([6,32,58,84,110]),new w(26,new h(8,106),new h(4,107)),new w(28,new h(8,47),new h(13,48)),new w(30,new h(7,24),new h(22,25)),new w(30,new h(22,15),new h(13,16))),new S(26,Int32Array.from([6,30,58,86,114]),new w(28,new h(10,114),new h(2,115)),new w(28,new h(19,46),new h(4,47)),new w(28,new h(28,22),new h(6,23)),new w(30,new h(33,16),new h(4,17))),new S(27,Int32Array.from([6,34,62,90,118]),new w(30,new h(8,122),new h(4,123)),new w(28,new h(22,45),new h(3,46)),new w(30,new h(8,23),new h(26,24)),new w(30,new h(12,15),new h(28,16))),new S(28,Int32Array.from([6,26,50,74,98,122]),new w(30,new h(3,117),new h(10,118)),new w(28,new h(3,45),new h(23,46)),new w(30,new h(4,24),new h(31,25)),new w(30,new h(11,15),new h(31,16))),new S(29,Int32Array.from([6,30,54,78,102,126]),new w(30,new h(7,116),new h(7,117)),new w(28,new h(21,45),new h(7,46)),new w(30,new h(1,23),new h(37,24)),new w(30,new h(19,15),new h(26,16))),new S(30,Int32Array.from([6,26,52,78,104,130]),new w(30,new h(5,115),new h(10,116)),new w(28,new h(19,47),new h(10,48)),new w(30,new h(15,24),new h(25,25)),new w(30,new h(23,15),new h(25,16))),new S(31,Int32Array.from([6,30,56,82,108,134]),new w(30,new h(13,115),new h(3,116)),new w(28,new h(2,46),new h(29,47)),new w(30,new h(42,24),new h(1,25)),new w(30,new h(23,15),new h(28,16))),new S(32,Int32Array.from([6,34,60,86,112,138]),new w(30,new h(17,115)),new w(28,new h(10,46),new h(23,47)),new w(30,new h(10,24),new h(35,25)),new w(30,new h(19,15),new h(35,16))),new S(33,Int32Array.from([6,30,58,86,114,142]),new w(30,new h(17,115),new h(1,116)),new w(28,new h(14,46),new h(21,47)),new w(30,new h(29,24),new h(19,25)),new w(30,new h(11,15),new h(46,16))),new S(34,Int32Array.from([6,34,62,90,118,146]),new w(30,new h(13,115),new h(6,116)),new w(28,new h(14,46),new h(23,47)),new w(30,new h(44,24),new h(7,25)),new w(30,new h(59,16),new h(1,17))),new S(35,Int32Array.from([6,30,54,78,102,126,150]),new w(30,new h(12,121),new h(7,122)),new w(28,new h(12,47),new h(26,48)),new w(30,new h(39,24),new h(14,25)),new w(30,new h(22,15),new h(41,16))),new S(36,Int32Array.from([6,24,50,76,102,128,154]),new w(30,new h(6,121),new h(14,122)),new w(28,new h(6,47),new h(34,48)),new w(30,new h(46,24),new h(10,25)),new w(30,new h(2,15),new h(64,16))),new S(37,Int32Array.from([6,28,54,80,106,132,158]),new w(30,new h(17,122),new h(4,123)),new w(28,new h(29,46),new h(14,47)),new w(30,new h(49,24),new h(10,25)),new w(30,new h(24,15),new h(46,16))),new S(38,Int32Array.from([6,32,58,84,110,136,162]),new w(30,new h(4,122),new h(18,123)),new w(28,new h(13,46),new h(32,47)),new w(30,new h(48,24),new h(14,25)),new w(30,new h(42,15),new h(32,16))),new S(39,Int32Array.from([6,26,54,82,110,138,166]),new w(30,new h(20,117),new h(4,118)),new w(28,new h(40,47),new h(7,48)),new w(30,new h(43,24),new h(22,25)),new w(30,new h(10,15),new h(67,16))),new S(40,Int32Array.from([6,30,58,86,114,142,170]),new w(30,new h(19,118),new h(6,119)),new w(28,new h(18,47),new h(31,48)),new w(30,new h(34,24),new h(34,25)),new w(30,new h(20,15),new h(61,16)))];class Pe{constructor(e){const t=e.getHeight();if(t<21||(3&t)!=1)throw new O;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let n=0;n<6;n++)e=this.copyBit(n,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let n=5;n>=0;n--)e=this.copyBit(8,n,e);const t=this.bitMatrix.getHeight();let r=0;const s=t-7;for(let n=t-1;n>=s;n--)r=this.copyBit(8,n,r);for(let n=t-8;n<t;n++)r=this.copyBit(n,8,r);if(this.parsedFormatInfo=x.decodeFormatInformation(e,r),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new O}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return S.getVersionForNumber(t);let r=0;const s=e-11;for(let i=5;i>=0;i--)for(let o=e-9;o>=s;o--)r=this.copyBit(o,i,r);let n=S.decodeVersionInformation(r);if(n!==null&&n.getDimensionForVersion()===e)return this.parsedVersion=n,n;r=0;for(let i=5;i>=0;i--)for(let o=e-9;o>=s;o--)r=this.copyBit(i,o,r);if(n=S.decodeVersionInformation(r),n!==null&&n.getDimensionForVersion()===e)return this.parsedVersion=n,n;throw new O}copyBit(e,t,r){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?r<<1|1:r<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),r=z.values.get(e.getDataMask()),s=this.bitMatrix.getHeight();r==null||r.unmaskBitMatrix(this.bitMatrix,s);const n=t.buildFunctionPattern();let i=!0;const o=new Uint8Array(t.getTotalCodewords());let a=0,c=0,u=0;for(let d=s-1;d>0;d-=2){d===6&&d--;for(let f=0;f<s;f++){const g=i?s-1-f:f;for(let m=0;m<2;m++)n.get(d-m,g)||(u++,c<<=1,this.bitMatrix.get(d-m,g)&&(c|=1),u===8&&(o[a++]=c,u=0,c=0))}i=!i}if(a!==t.getTotalCodewords())throw new O;return o}remask(){if(this.parsedFormatInfo===null)return;const e=this.parsedFormatInfo&&z.values.get(this.parsedFormatInfo.getDataMask()),t=this.bitMatrix.getHeight();e==null||e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,r=e.getWidth();t<r;t++)for(let s=t+1,n=e.getHeight();s<n;s++)e.get(t,s)!==e.get(s,t)&&(e.flip(s,t),e.flip(t,s))}}class Ae{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,r){if(e.length!==t.getTotalCodewords())throw new N;const s=t.getECBlocksForLevel(r);let n=0;const i=s.getECBlocks();for(const m of i)n+=m.getCount();const o=new Array(n);let a=0;for(const m of i)for(let C=0;C<m.getCount();C++){const A=m.getDataCodewords(),M=s.getECCodewordsPerBlock()+A;o[a++]=new Ae(A,new Uint8Array(M))}const c=o[0].codewords.length;let u=o.length-1;for(;u>=0&&o[u].codewords.length!==c;)u--;u++;const d=c-s.getECCodewordsPerBlock();let f=0;for(let m=0;m<d;m++)for(let C=0;C<a;C++)o[C].codewords[m]=e[f++];for(let m=u;m<a;m++)o[m].codewords[d]=e[f++];const g=o[0].codewords.length;for(let m=d;m<g;m++)for(let C=0;C<a;C++){const A=C<u?m:m+1;o[C].codewords[A]=e[f++]}return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class ve{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new N(""+e);let t=0,r=this.bitOffset,s=this.byteOffset;const n=this.bytes;if(r>0){const i=8-r,o=e<i?e:i,a=i-o,c=255>>8-o<<a;t=(n[s]&c)>>a,e-=o,r+=o,r===8&&(r=0,s++)}if(e>0){for(;e>=8;)t=t<<8|255&n[s],s++,e-=8;if(e>0){const i=8-e,o=255>>i<<i;t=t<<e|(n[s]&o)>>i,r+=e}}return this.bitOffset=r,this.byteOffset=s,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}class Fe{constructor(e,t,r,s,n=-1,i=-1){this.rawBytes=e,this.text=t,this.byteSegments=r,this.ecLevel=s,this.structuredAppendSequenceNumber=n,this.structuredAppendParity=i,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}(function(l){l[l.TERMINATOR=0]="TERMINATOR",l[l.NUMERIC=1]="NUMERIC",l[l.ALPHANUMERIC=2]="ALPHANUMERIC",l[l.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",l[l.BYTE=4]="BYTE",l[l.ECI=5]="ECI",l[l.KANJI=6]="KANJI",l[l.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",l[l.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",l[l.HANZI=9]="HANZI"})(L||(L={}));class E{constructor(e,t,r,s){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=r,this.bits=s,E.FOR_BITS.set(s,this),E.FOR_VALUE.set(e,this)}static forBits(e){const t=E.FOR_BITS.get(e);if(t===void 0)throw new N;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let r;return r=t<=9?0:t<=26?1:2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof E))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}E.FOR_BITS=new Map,E.FOR_VALUE=new Map,E.TERMINATOR=new E(L.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),E.NUMERIC=new E(L.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),E.ALPHANUMERIC=new E(L.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),E.STRUCTURED_APPEND=new E(L.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),E.BYTE=new E(L.BYTE,"BYTE",Int32Array.from([8,16,16]),4),E.ECI=new E(L.ECI,"ECI",Int32Array.from([0,0,0]),7),E.KANJI=new E(L.KANJI,"KANJI",Int32Array.from([8,10,12]),8),E.FNC1_FIRST_POSITION=new E(L.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),E.FNC1_SECOND_POSITION=new E(L.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),E.HANZI=new E(L.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class R{static decode(e,t,r,s){const n=new ve(e);let i=new Se;const o=new Array;let a=-1,c=-1;try{let u,d=null,f=!1;do{if(n.available()<4)u=E.TERMINATOR;else{const g=n.readBits(4);u=E.forBits(g)}switch(u){case E.TERMINATOR:break;case E.FNC1_FIRST_POSITION:case E.FNC1_SECOND_POSITION:f=!0;break;case E.STRUCTURED_APPEND:if(n.available()<16)throw new O;a=n.readBits(8),c=n.readBits(8);break;case E.ECI:const g=R.parseECIValue(n);if(d=I.getCharacterSetECIByValue(g),d===null)throw new O;break;case E.HANZI:const m=n.readBits(4),C=n.readBits(u.getCharacterCountBits(t));m===R.GB2312_SUBSET&&R.decodeHanziSegment(n,i,C);break;default:const A=n.readBits(u.getCharacterCountBits(t));switch(u){case E.NUMERIC:R.decodeNumericSegment(n,i,A);break;case E.ALPHANUMERIC:R.decodeAlphanumericSegment(n,i,A,f);break;case E.BYTE:R.decodeByteSegment(n,i,A,d,o,s);break;case E.KANJI:R.decodeKanjiSegment(n,i,A);break;default:throw new O}}}while(u!==E.TERMINATOR)}catch{throw new O}return new Fe(e,i.toString(),o.length===0?null:o,r===null?null:r.toString(),a,c)}static decodeHanziSegment(e,t,r){if(13*r>e.available())throw new O;const s=new Uint8Array(2*r);let n=0;for(;r>0;){const i=e.readBits(13);let o=i/96<<8&4294967295|i%96;o+=o<959?41377:42657,s[n]=o>>8&255,s[n+1]=255&o,n+=2,r--}try{t.append(Q.decode(s,B.GB2312))}catch(i){throw new O(i)}}static decodeKanjiSegment(e,t,r){if(13*r>e.available())throw new O;const s=new Uint8Array(2*r);let n=0;for(;r>0;){const i=e.readBits(13);let o=i/192<<8&4294967295|i%192;o+=o<7936?33088:49472,s[n]=o>>8,s[n+1]=o,n+=2,r--}try{t.append(Q.decode(s,B.SHIFT_JIS))}catch(i){throw new O(i)}}static decodeByteSegment(e,t,r,s,n,i){if(8*r>e.available())throw new O;const o=new Uint8Array(r);for(let c=0;c<r;c++)o[c]=e.readBits(8);let a;a=s===null?B.guessEncoding(o,i):s.getName();try{t.append(Q.decode(o,a))}catch(c){throw new O(c)}n.push(o)}static toAlphaNumericChar(e){if(e>=R.ALPHANUMERIC_CHARS.length)throw new O;return R.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,r,s){const n=t.length();for(;r>1;){if(e.available()<11)throw new O;const i=e.readBits(11);t.append(R.toAlphaNumericChar(Math.floor(i/45))),t.append(R.toAlphaNumericChar(i%45)),r-=2}if(r===1){if(e.available()<6)throw new O;t.append(R.toAlphaNumericChar(e.readBits(6)))}if(s)for(let i=n;i<t.length();i++)t.charAt(i)==="%"&&(i<t.length()-1&&t.charAt(i+1)==="%"?t.deleteCharAt(i+1):t.setCharAt(i,""))}static decodeNumericSegment(e,t,r){for(;r>=3;){if(e.available()<10)throw new O;const s=e.readBits(10);if(s>=1e3)throw new O;t.append(R.toAlphaNumericChar(Math.floor(s/100))),t.append(R.toAlphaNumericChar(Math.floor(s/10)%10)),t.append(R.toAlphaNumericChar(s%10)),r-=3}if(r===2){if(e.available()<7)throw new O;const s=e.readBits(7);if(s>=100)throw new O;t.append(R.toAlphaNumericChar(Math.floor(s/10))),t.append(R.toAlphaNumericChar(s%10))}else if(r===1){if(e.available()<4)throw new O;const s=e.readBits(4);if(s>=10)throw new O;t.append(R.toAlphaNumericChar(s))}}static parseECIValue(e){const t=e.readBits(8);if(!(128&t))return 127&t;if((192&t)==128)return(63&t)<<8&4294967295|e.readBits(8);if((224&t)==192)return(31&t)<<16&4294967295|e.readBits(16);throw new O}}R.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",R.GB2312_SUBSET=1;class Ie{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class Ue{constructor(){this.rsDecoder=new De(v.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(K.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const r=new Pe(e);let s=null;try{return this.decodeBitMatrixParser(r,t)}catch(n){s=n}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const n=this.decodeBitMatrixParser(r,t);return n.setOther(new Ie(!0)),n}catch(n){throw s!==null?s:n}}decodeBitMatrixParser(e,t){const r=e.readVersion(),s=e.readFormatInformation().getErrorCorrectionLevel(),n=e.readCodewords(),i=Ae.getDataBlocks(n,r,s);let o=0;for(const u of i)o+=u.getNumDataCodewords();const a=new Uint8Array(o);let c=0;for(const u of i){const d=u.getCodewords(),f=u.getNumDataCodewords();this.correctErrors(d,f);for(let g=0;g<f;g++)a[c++]=d[g]}return R.decode(a,r,s,t)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch{throw new we}for(let s=0;s<t;s++)e[s]=r[s]}}class oe{constructor(){}static round(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,r,s){const n=e-r,i=t-s;return Math.sqrt(n*n+i*i)}static sum(e){let t=0;for(let r=0,s=e.length;r!==s;r++)t+=e[r];return t}}class ke{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Ne{static checkAndNudgePoints(e,t){const r=e.getWidth(),s=e.getHeight();let n=!0;for(let i=0;i<t.length&&n;i+=2){const o=Math.floor(t[i]),a=Math.floor(t[i+1]);if(o<-1||o>r||a<-1||a>s)throw new _;n=!1,o===-1?(t[i]=0,n=!0):o===r&&(t[i]=r-1,n=!0),a===-1?(t[i+1]=0,n=!0):a===s&&(t[i+1]=s-1,n=!0)}n=!0;for(let i=t.length-2;i>=0&&n;i-=2){const o=Math.floor(t[i]),a=Math.floor(t[i+1]);if(o<-1||o>r||a<-1||a>s)throw new _;n=!1,o===-1?(t[i]=0,n=!0):o===r&&(t[i]=r-1,n=!0),a===-1?(t[i+1]=0,n=!0):a===s&&(t[i+1]=s-1,n=!0)}}}class W{constructor(e,t,r,s,n,i,o,a,c){this.a11=e,this.a21=t,this.a31=r,this.a12=s,this.a22=n,this.a32=i,this.a13=o,this.a23=a,this.a33=c}static quadrilateralToQuadrilateral(e,t,r,s,n,i,o,a,c,u,d,f,g,m,C,A){const M=W.quadrilateralToSquare(e,t,r,s,n,i,o,a);return W.squareToQuadrilateral(c,u,d,f,g,m,C,A).times(M)}transformPoints(e){const t=e.length,r=this.a11,s=this.a12,n=this.a13,i=this.a21,o=this.a22,a=this.a23,c=this.a31,u=this.a32,d=this.a33;for(let f=0;f<t;f+=2){const g=e[f],m=e[f+1],C=n*g+a*m+d;e[f]=(r*g+i*m+c)/C,e[f+1]=(s*g+o*m+u)/C}}transformPointsWithValues(e,t){const r=this.a11,s=this.a12,n=this.a13,i=this.a21,o=this.a22,a=this.a23,c=this.a31,u=this.a32,d=this.a33,f=e.length;for(let g=0;g<f;g++){const m=e[g],C=t[g],A=n*m+a*C+d;e[g]=(r*m+i*C+c)/A,t[g]=(s*m+o*C+u)/A}}static squareToQuadrilateral(e,t,r,s,n,i,o,a){const c=e-r+n-o,u=t-s+i-a;if(c===0&&u===0)return new W(r-e,n-r,e,s-t,i-s,t,0,0,1);{const d=r-n,f=o-n,g=s-i,m=a-i,C=d*m-f*g,A=(c*m-f*u)/C,M=(d*u-c*g)/C;return new W(r-e+A*r,o-e+M*o,e,s-t+A*s,a-t+M*a,t,A,M,1)}}static quadrilateralToSquare(e,t,r,s,n,i,o,a){return W.squareToQuadrilateral(e,t,r,s,n,i,o,a).buildAdjoint()}buildAdjoint(){return new W(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new W(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class ue{static setGridSampler(e){ue.gridSampler=e}static getInstance(){return ue.gridSampler}}ue.gridSampler=new class extends Ne{sampleGrid(l,e,t,r,s,n,i,o,a,c,u,d,f,g,m,C,A,M,U){const b=W.quadrilateralToQuadrilateral(r,s,n,i,o,a,c,u,d,f,g,m,C,A,M,U);return this.sampleGridWithTransform(l,e,t,b)}sampleGridWithTransform(l,e,t,r){if(e<=0||t<=0)throw new _;const s=new K(e,t),n=new Float32Array(2*e);for(let i=0;i<t;i++){const o=n.length,a=i+.5;for(let c=0;c<o;c+=2)n[c]=c/2+.5,n[c+1]=a;r.transformPoints(n),Ne.checkAndNudgePoints(l,n);try{for(let c=0;c<o;c+=2)l.get(Math.floor(n[c]),Math.floor(n[c+1]))&&s.set(c/2,i)}catch{throw new _}}return s}};class Ce{static floatToIntBits(e){return e}}Ce.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ee{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof ee){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*Ce.floatToIntBits(this.x)+Ce.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),r=this.distance(e[1],e[2]),s=this.distance(e[0],e[2]);let n,i,o;if(r>=t&&r>=s?(i=e[0],n=e[1],o=e[2]):s>=r&&s>=t?(i=e[1],n=e[0],o=e[2]):(i=e[2],n=e[0],o=e[1]),this.crossProductZ(n,i,o)<0){const a=n;n=o,o=a}e[0]=n,e[1]=i,e[2]=o}static distance(e,t){return oe.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,r){const s=t.x,n=t.y;return(r.x-s)*(e.y-n)-(r.y-n)*(e.x-s)}}class Ee extends ee{constructor(e,t,r){super(e,t),this.estimatedModuleSize=r}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const s=Math.abs(e-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const s=(this.getX()+t)/2,n=(this.getY()+e)/2,i=(this.estimatedModuleSize+r)/2;return new Ee(s,n,i)}}class ge{constructor(e,t,r,s,n,i,o){this.image=e,this.startX=t,this.startY=r,this.width=s,this.height=n,this.moduleSize=i,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,r=e+this.width,s=this.startY+t/2,n=new Int32Array(3),i=this.image;for(let o=0;o<t;o++){const a=s+(1&o?-Math.floor((o+1)/2):Math.floor((o+1)/2));n[0]=0,n[1]=0,n[2]=0;let c=e;for(;c<r&&!i.get(c,a);)c++;let u=0;for(;c<r;){if(i.get(c,a))if(u===1)n[1]++;else if(u===2){if(this.foundPatternCross(n)){const d=this.handlePossibleCenter(n,a,c);if(d!==null)return d}n[0]=n[2],n[1]=1,n[2]=0,u=1}else n[++u]++;else u===1&&u++,n[u]++;c++}if(this.foundPatternCross(n)){const d=this.handlePossibleCenter(n,a,r);if(d!==null)return d}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new _}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,r=t/2;for(let s=0;s<3;s++)if(Math.abs(t-e[s])>=r)return!1;return!0}crossCheckVertical(e,t,r,s){const n=this.image,i=n.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;let a=e;for(;a>=0&&n.get(t,a)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&!n.get(t,a)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<i&&n.get(t,a)&&o[1]<=r;)o[1]++,a++;if(a===i||o[1]>r)return NaN;for(;a<i&&!n.get(t,a)&&o[2]<=r;)o[2]++,a++;if(o[2]>r)return NaN;const c=o[0]+o[1]+o[2];return 5*Math.abs(c-s)>=2*s?NaN:this.foundPatternCross(o)?ge.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,r){const s=e[0]+e[1]+e[2],n=ge.centerFromEnd(e,r),i=this.crossCheckVertical(t,n,2*e[1],s);if(!isNaN(i)){const o=(e[0]+e[1]+e[2])/3;for(const c of this.possibleCenters)if(c.aboutEquals(o,i,n))return c.combineEstimate(i,n,o);const a=new Ee(n,i,o);this.possibleCenters.push(a),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(a)}return null}}class pe extends ee{constructor(e,t,r,s){super(e,t),this.estimatedModuleSize=r,this.count=s,s===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const s=Math.abs(e-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const s=this.count??0,n=s+1,i=(s*this.getX()+t)/n,o=(s*this.getY()+e)/n,a=(s*this.estimatedModuleSize+r)/n;return new pe(i,o,a,n)}}class xe{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class F{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(Y.TRY_HARDER)!==void 0,r=e!=null&&e.get(Y.PURE_BARCODE)!==void 0,s=this.image,n=s.getHeight(),i=s.getWidth();let o=Math.floor(3*n/(4*F.MAX_MODULES));(o<F.MIN_SKIP||t)&&(o=F.MIN_SKIP);let a=!1;const c=new Int32Array(5);for(let d=o-1;d<n&&!a;d+=o){c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0;let f=0;for(let g=0;g<i;g++)if(s.get(g,d))1&~f||f++,c[f]++;else if(1&f)c[f]++;else if(f===4)if(F.foundPatternCross(c)){if(this.handlePossibleCenter(c,d,g,r)!==!0){c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,f=3;continue}if(o=2,this.hasSkipped===!0)a=this.haveMultiplyConfirmedCenters();else{const m=this.findRowSkip();m>c[2]&&(d+=m-c[2]-o,g=i-1)}f=0,c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0}else c[0]=c[2],c[1]=c[3],c[2]=c[4],c[3]=1,c[4]=0,f=3;else c[++f]++;F.foundPatternCross(c)&&this.handlePossibleCenter(c,d,i,r)===!0&&(o=c[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const u=this.selectBestPatterns();return ee.orderBestPatterns(u),new xe(u)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let n=0;n<5;n++){const i=e[n];if(i===0)return!1;t+=i}if(t<7)return!1;const r=t/7,s=r/2;return Math.abs(r-e[0])<s&&Math.abs(r-e[1])<s&&Math.abs(3*r-e[2])<3*s&&Math.abs(r-e[3])<s&&Math.abs(r-e[4])<s}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,r,s){const n=this.getCrossCheckStateCount();let i=0;const o=this.image;for(;e>=i&&t>=i&&o.get(t-i,e-i);)n[2]++,i++;if(e<i||t<i)return!1;for(;e>=i&&t>=i&&!o.get(t-i,e-i)&&n[1]<=r;)n[1]++,i++;if(e<i||t<i||n[1]>r)return!1;for(;e>=i&&t>=i&&o.get(t-i,e-i)&&n[0]<=r;)n[0]++,i++;if(n[0]>r)return!1;const a=o.getHeight(),c=o.getWidth();for(i=1;e+i<a&&t+i<c&&o.get(t+i,e+i);)n[2]++,i++;if(e+i>=a||t+i>=c)return!1;for(;e+i<a&&t+i<c&&!o.get(t+i,e+i)&&n[3]<r;)n[3]++,i++;if(e+i>=a||t+i>=c||n[3]>=r)return!1;for(;e+i<a&&t+i<c&&o.get(t+i,e+i)&&n[4]<r;)n[4]++,i++;if(n[4]>=r)return!1;const u=n[0]+n[1]+n[2]+n[3]+n[4];return Math.abs(u-s)<2*s&&F.foundPatternCross(n)}crossCheckVertical(e,t,r,s){const n=this.image,i=n.getHeight(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&n.get(t,a);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!n.get(t,a)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&n.get(t,a)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<i&&n.get(t,a);)o[2]++,a++;if(a===i)return NaN;for(;a<i&&!n.get(t,a)&&o[3]<r;)o[3]++,a++;if(a===i||o[3]>=r)return NaN;for(;a<i&&n.get(t,a)&&o[4]<r;)o[4]++,a++;if(o[4]>=r)return NaN;const c=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(c-s)>=2*s?NaN:F.foundPatternCross(o)?F.centerFromEnd(o,a):NaN}crossCheckHorizontal(e,t,r,s){const n=this.image,i=n.getWidth(),o=this.getCrossCheckStateCount();let a=e;for(;a>=0&&n.get(a,t);)o[2]++,a--;if(a<0)return NaN;for(;a>=0&&!n.get(a,t)&&o[1]<=r;)o[1]++,a--;if(a<0||o[1]>r)return NaN;for(;a>=0&&n.get(a,t)&&o[0]<=r;)o[0]++,a--;if(o[0]>r)return NaN;for(a=e+1;a<i&&n.get(a,t);)o[2]++,a++;if(a===i)return NaN;for(;a<i&&!n.get(a,t)&&o[3]<r;)o[3]++,a++;if(a===i||o[3]>=r)return NaN;for(;a<i&&n.get(a,t)&&o[4]<r;)o[4]++,a++;if(o[4]>=r)return NaN;const c=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(c-s)>=s?NaN:F.foundPatternCross(o)?F.centerFromEnd(o,a):NaN}handlePossibleCenter(e,t,r,s){const n=e[0]+e[1]+e[2]+e[3]+e[4];let i=F.centerFromEnd(e,r),o=this.crossCheckVertical(t,Math.floor(i),e[2],n);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],n),!isNaN(i)&&(!s||this.crossCheckDiagonal(Math.floor(o),Math.floor(i),e[2],n)))){const a=n/7;let c=!1;const u=this.possibleCenters;for(let d=0,f=u.length;d<f;d++){const g=u[d];if(g.aboutEquals(a,o,i)){u[d]=g.combineEstimate(o,i,a),c=!0;break}}if(!c){const d=new pe(i,o,a);u.push(d),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(d)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let e=null;for(const t of this.possibleCenters){const r=t==null?void 0:t.getCount();if(r!==void 0&&r>=F.CENTER_QUORUM){if(e!=null)return this.hasSkipped=!0,Math.floor((Math.abs(e.getX()-t.getX())-Math.abs(e.getY()-t.getY()))/2);e=t}}return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const r=this.possibleCenters.length;for(const i of this.possibleCenters){const o=i.getCount();o!==void 0&&o>=F.CENTER_QUORUM&&(e++,t+=i.getEstimatedModuleSize())}if(e<3)return!1;const s=t/r;let n=0;for(const i of this.possibleCenters)n+=Math.abs(i.getEstimatedModuleSize()-s);return n<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new _;const t=this.possibleCenters;let r;if(e>3){let s=0,n=0;for(const a of this.possibleCenters){const c=a.getEstimatedModuleSize();s+=c,n+=c*c}r=s/e;let i=Math.sqrt(n/e-r*r);t.sort((a,c)=>{const u=Math.abs(c.getEstimatedModuleSize()-r),d=Math.abs(a.getEstimatedModuleSize()-r);return u<d?-1:u>d?1:0});const o=Math.max(.2*r,i);for(let a=0;a<t.length&&t.length>3;a++){const c=t[a];Math.abs(c.getEstimatedModuleSize()-r)>o&&(t.splice(a,1),a--)}}if(t.length>3){let s=0;for(const n of t)s+=n.getEstimatedModuleSize();r=s/t.length,t.sort((n,i)=>{if(i.getCount()===n.getCount()){const o=Math.abs(i.getEstimatedModuleSize()-r),a=Math.abs(n.getEstimatedModuleSize()-r);return o<a?1:o>a?-1:0}return(i.getCount()??0)-(n.getCount()??0)}),t.splice(3)}return[t[0],t[1],t[2]]}}F.CENTER_QUORUM=2,F.MIN_SKIP=3,F.MAX_MODULES=57;class he{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(Y.NEED_RESULT_POINT_CALLBACK);const t=new F(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(t)}processFinderPatternInfo(e){const t=e.getTopLeft(),r=e.getTopRight(),s=e.getBottomLeft(),n=this.calculateModuleSize(t,r,s);if(n<1)throw new _("No pattern found in proccess finder.");const i=he.computeDimension(t,r,s,n),o=S.getProvisionalVersionForDimension(i),a=o.getDimensionForVersion()-7;let c=null;if(o.getAlignmentPatternCenters().length>0){const g=r.getX()-t.getX()+s.getX(),m=r.getY()-t.getY()+s.getY(),C=1-3/a,A=Math.floor(t.getX()+C*(g-t.getX())),M=Math.floor(t.getY()+C*(m-t.getY()));for(let U=4;U<=16;U<<=1)try{c=this.findAlignmentInRegion(n,A,M,U);break}catch(b){if(!(b instanceof _))throw b}}const u=he.createTransform(t,r,s,c,i),d=he.sampleGrid(this.image,u,i);let f;return f=c===null?[s,t,r]:[s,t,r,c],new ke(d,f)}static createTransform(e,t,r,s,n){const i=n-3.5;let o,a,c,u;return s!==null?(o=s.getX(),a=s.getY(),c=i-3,u=c):(o=t.getX()-e.getX()+r.getX(),a=t.getY()-e.getY()+r.getY(),c=i,u=i),W.quadrilateralToQuadrilateral(3.5,3.5,i,3.5,c,u,3.5,i,e.getX(),e.getY(),t.getX(),t.getY(),o,a,r.getX(),r.getY())}static sampleGrid(e,t,r){return ue.getInstance().sampleGridWithTransform(e,r,r,t)}static computeDimension(e,t,r,s){const n=oe.round(ee.distance(e,t)/s),i=oe.round(ee.distance(e,r)/s);let o=Math.floor((n+i)/2)+7;switch(3&o){case 0:o++;break;case 2:o--;break;case 3:throw new _("Dimensions could be not found.")}return o}calculateModuleSize(e,t,r){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,r))/2}calculateModuleSizeOneWay(e,t){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),s=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(r)?s/7:isNaN(s)?r/7:(r+s)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,r,s){let n=this.sizeOfBlackWhiteBlackRun(e,t,r,s),i=1,o=e-(r-e);o<0?(i=e/(e-o),o=0):o>=this.image.getWidth()&&(i=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);let a=Math.floor(t-(s-t)*i);return i=1,a<0?(i=t/(t-a),a=0):a>=this.image.getHeight()&&(i=(this.image.getHeight()-1-t)/(a-t),a=this.image.getHeight()-1),o=Math.floor(e+(o-e)*i),n+=this.sizeOfBlackWhiteBlackRun(e,t,o,a),n-1}sizeOfBlackWhiteBlackRun(e,t,r,s){const n=Math.abs(s-t)>Math.abs(r-e);if(n){let g=e;e=t,t=g,g=r,r=s,s=g}const i=Math.abs(r-e),o=Math.abs(s-t);let a=-i/2;const c=e<r?1:-1,u=t<s?1:-1;let d=0;const f=r+c;for(let g=e,m=t;g!==f;g+=c){const C=n?m:g,A=n?g:m;if(d===1===this.image.get(C,A)){if(d===2)return oe.distance(g,m,e,t);d++}if(a+=o,a>0){if(m===s)break;m+=u,a-=i}}return d===2?oe.distance(r+c,s,e,t):NaN}findAlignmentInRegion(e,t,r,s){const n=Math.floor(s*e),i=Math.max(0,t-n),o=Math.min(this.image.getWidth()-1,t+n);if(o-i<3*e)throw new _("Alignment top exceeds estimated module size.");const a=Math.max(0,r-n),c=Math.min(this.image.getHeight()-1,r+n);if(c-a<3*e)throw new _("Alignment bottom exceeds estimated module size.");return new ge(this.image,i,a,o-i,c-a,e,this.resultPointCallback).find()}}class j{constructor(){this.decoder=new Ue}getDecoder(){return this.decoder}decode(e,t){let r,s;const n=t??new Map().set(Y.TRY_HARDER,!0);try{const c=j.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(c,n),s=j.NO_POINTS}catch{const u=new he(e.getBlackMatrix()).detect(n);r=this.decoder.decodeBitMatrix(u.getBits(),n),s=u.getPoints()}r.getOther()instanceof Ie&&r.getOther().applyMirroredCorrection(s);const i=new Oe(r.getText(),r.getRawBytes(),void 0,s,fe.QR_CODE,void 0),o=r.getByteSegments();o&&i.putMetadata(G.BYTE_SEGMENTS,o);const a=r.getECLevel();return a&&i.putMetadata(G.ERROR_CORRECTION_LEVEL,a),r.hasStructuredAppend()&&(i.putMetadata(G.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),i.putMetadata(G.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),i}decode2(e,t){let r,s;const n=t==null||t==null?new Map().set(Y.TRY_HARDER,!0):void 0;console.log("hintsDef",n);const i=j.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(i,n),s=j.NO_POINTS,r.getOther()instanceof Ie&&r.getOther().applyMirroredCorrection(s);const o=new Oe(r.getText(),r.getRawBytes(),void 0,s,fe.QR_CODE,void 0),a=r.getByteSegments();a!==null&&o.putMetadata(G.BYTE_SEGMENTS,a);const c=r.getECLevel();return c!==null&&o.putMetadata(G.ERROR_CORRECTION_LEVEL,c),r.hasStructuredAppend()&&(o.putMetadata(G.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),o.putMetadata(G.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),o}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(t===null||r===null)throw new _;const s=this.moduleSize(t,e);let n=t[1],i=r[1],o=t[0],a=r[0];if(o>=a||n>=i)throw new _;if(i-n!=a-o&&(a=o+(i-n),a>=e.getWidth()))throw new _;const c=Math.round((a-o+1)/s),u=Math.round((i-n+1)/s);if(c<=0||u<=0)throw new _;if(u!==c)throw new _;const d=Math.floor(s/2);n+=d,o+=d;const f=o+Math.floor((c-1)*s)-a;if(f>0){if(f>d)throw new _;o-=f}const g=n+Math.floor((u-1)*s)-i;if(g>0){if(g>d)throw new _;n-=g}const m=new K(c,u);for(let C=0;C<u;C++){const A=n+Math.floor(C*s);for(let M=0;M<c;M++)e.get(o+Math.floor(M*s),A)&&m.set(M,C)}return m}static moduleSize(e,t){const r=t.getHeight(),s=t.getWidth();let n=e[0],i=e[1],o=!0,a=0;for(;n<s&&i<r;){if(o!==t.get(n,i)){if(++a==5)break;o=!o}n++,i++}if(n===s||i===r)throw new _;return(n-e[0])/7}}j.NO_POINTS=new Array;class le{constructor(e){if(this.binarizer=e,e===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return this.matrix!==null&&this.matrix!==void 0||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,r,s){const n=this.binarizer.getLuminanceSource().crop(e,t,r,s);return new le(this.binarizer.createBinarizer(n))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new le(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new le(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class Le{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class k extends Le{constructor(e){super(e),this.luminances=k.EMPTY,this.buckets=new Int32Array(k.LUMINANCE_BUCKETS)}getBlackRow(e,t){const r=this.getLuminanceSource(),s=r.getWidth();t==null||t.getSize()<s?t=new Z(s):t.clear(),this.initArrays(s);const n=r.getRow(e,this.luminances),i=this.buckets;for(let a=0;a<s;a++)i[(255&n[a])>>k.LUMINANCE_SHIFT]++;const o=k.estimateBlackPoint(i);if(s<3)for(let a=0;a<s;a++)(255&n[a])<o&&t.set(a);else{let a=255&n[0],c=255&n[1];for(let u=1;u<s-1;u++){const d=255&n[u+1];(4*c-a-d)/2<o&&t.set(u),a=c,c=d}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight(),s=new K(t,r);this.initArrays(t);const n=this.buckets;for(let a=1;a<5;a++){const c=Math.floor(r*a/5),u=e.getRow(c,this.luminances),d=Math.floor(4*t/5);for(let f=Math.floor(t/5);f<d;f++)n[(255&u[f])>>k.LUMINANCE_SHIFT]++}const i=k.estimateBlackPoint(n),o=e.getMatrix();for(let a=0;a<r;a++){const c=a*t;for(let u=0;u<t;u++)(255&o[c+u])<i&&s.set(u,a)}return s}createBinarizer(e){return new k(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let r=0;r<k.LUMINANCE_BUCKETS;r++)t[r]=0}static estimateBlackPoint(e){const t=e.length;let r=0,s=0,n=0;for(let u=0;u<t;u++)e[u]>n&&(s=u,n=e[u]),e[u]>r&&(r=e[u]);let i=0,o=0;for(let u=0;u<t;u++){const d=u-s,f=e[u]*d*d;f>o&&(i=u,o=f)}if(s>i){const u=s;s=i,i=u}if(i-s<=t/16)throw new _;let a=i-1,c=-1;for(let u=i-1;u>s;u--){const d=u-s,f=d*d*(i-u)*(r-e[u]);f>c&&(a=u,c=f)}return a<<k.LUMINANCE_SHIFT}}k.LUMINANCE_BITS=5,k.LUMINANCE_SHIFT=8-k.LUMINANCE_BITS,k.LUMINANCE_BUCKETS=1<<k.LUMINANCE_BITS,k.EMPTY=Uint8ClampedArray.from([0]);class p extends k{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight();if(t>=p.MINIMUM_DIMENSION&&r>=p.MINIMUM_DIMENSION){const s=e.getMatrix();let n=t>>p.BLOCK_SIZE_POWER;t&p.BLOCK_SIZE_MASK&&n++;let i=r>>p.BLOCK_SIZE_POWER;r&p.BLOCK_SIZE_MASK&&i++;const o=p.calculateBlackPoints(s,n,i,t,r),a=new K(t,r);p.calculateThresholdForBlock(s,n,i,t,r,o,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new p(e)}static calculateThresholdForBlock(e,t,r,s,n,i,o){const a=n-p.BLOCK_SIZE,c=s-p.BLOCK_SIZE;for(let u=0;u<r;u++){let d=u<<p.BLOCK_SIZE_POWER;d>a&&(d=a);const f=p.cap(u,2,r-3);for(let g=0;g<t;g++){let m=g<<p.BLOCK_SIZE_POWER;m>c&&(m=c);const C=p.cap(g,2,t-3);let A=0;for(let U=-2;U<=2;U++){const b=i[f+U];A+=b[C-2]+b[C-1]+b[C]+b[C+1]+b[C+2]}const M=A/25;p.thresholdBlock(e,m,d,M,s,o)}}}static cap(e,t,r){return e<t?t:e>r?r:e}static thresholdBlock(e,t,r,s,n,i){for(let o=0,a=r*n+t;o<p.BLOCK_SIZE;o++,a+=n)for(let c=0;c<p.BLOCK_SIZE;c++)(255&e[a+c])<=s&&i.set(t+c,r+o)}static calculateBlackPoints(e,t,r,s,n){const i=n-p.BLOCK_SIZE,o=s-p.BLOCK_SIZE,a=new Array(r);for(let c=0;c<r;c++){a[c]=new Int32Array(t);let u=c<<p.BLOCK_SIZE_POWER;u>i&&(u=i);for(let d=0;d<t;d++){let f=d<<p.BLOCK_SIZE_POWER;f>o&&(f=o);let g=0,m=255,C=0;for(let M=0,U=u*s+f;M<p.BLOCK_SIZE;M++,U+=s){for(let b=0;b<p.BLOCK_SIZE;b++){const T=255&e[U+b];g+=T,T<m&&(m=T),T>C&&(C=T)}if(C-m>p.MIN_DYNAMIC_RANGE)for(M++,U+=s;M<p.BLOCK_SIZE;M++,U+=s)for(let b=0;b<p.BLOCK_SIZE;b++)g+=255&e[U+b]}let A=g>>2*p.BLOCK_SIZE_POWER;if(C-m<=p.MIN_DYNAMIC_RANGE&&(A=m/2,c>0&&d>0)){const M=(a[c-1][d]+2*a[c][d-1]+a[c-1][d-1])/4;m<M&&(A=M)}a[c][d]=A}}return a}}p.BLOCK_SIZE_POWER=3,p.BLOCK_SIZE=1<<p.BLOCK_SIZE_POWER,p.BLOCK_SIZE_MASK=p.BLOCK_SIZE-1,p.MINIMUM_DIMENSION=5*p.BLOCK_SIZE,p.MIN_DYNAMIC_RANGE=24;class Me{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,r,s){throw new ae("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new ae("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new ae("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new Se;for(let r=0;r<this.height;r++){const s=this.getRow(r,e);for(let n=0;n<this.width;n++){const i=255&s[n];let o;o=i<64?"#":i<128?"+":i<192?".":" ",t.append(o)}t.append(`
`)}return t.toString()}}class re extends Me{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const r=this.delegate.getRow(e,t),s=this.getWidth();for(let n=0;n<s;n++)r[n]=255-(255&r[n]);return r}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(t);for(let s=0;s<t;s++)r[s]=255-(255&e[s]);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,r,s){return new re(this.delegate.crop(e,t,r,s))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new re(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new re(this.delegate.rotateCounterClockwise45())}}class ce extends Me{constructor(e,t=128){super(e.getWidth(),e.getHeight()),this.delegate=e,this.threshold=t}getRow(e,t){const r=this.delegate.getRow(e,t),s=this.getWidth();for(let n=0;n<s;n++)r[n]=r[n]<this.threshold?0:255;return r}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(t);for(let s=0;s<t;s++)r[s]=e[s]<this.threshold?0:255;return r}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,r,s){return new ce(this.delegate.crop(e,t,r,s),this.threshold)}isRotateSupported(){return this.delegate.isRotateSupported()}rotateCounterClockwise(){return new ce(this.delegate.rotateCounterClockwise(),this.threshold)}rotateCounterClockwise45(){return new ce(this.delegate.rotateCounterClockwise45(),this.threshold)}invert(){return new re(this)}highContrast(){return this}}class H extends Me{constructor(e,t=!1){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=H.makeBufferFromCanvasImageData(e,t)}static makeBufferFromCanvasImageData(e,t=!1){const r=e.getContext("2d").getImageData(0,0,e.width,e.height);return H.toGrayscaleBuffer(r.data,e.width,e.height,t)}static toGrayscaleBuffer(e,t,r,s=!1){const n=new Uint8ClampedArray(t*r);if(H.FRAME_INDEX=!H.FRAME_INDEX,H.FRAME_INDEX||!s)for(let i=0,o=0,a=e.length;i<a;i+=4,o++){let c;e[i+3]===0?c=255:c=306*e[i]+601*e[i+1]+117*e[i+2]+512>>10,n[o]=c}else for(let i=0,o=0,a=e.length;i<a;i+=4,o++){let c;e[i+3]===0?c=255:c=306*e[i]+601*e[i+1]+117*e[i+2]+512>>10,n[o]=255-c}return n}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const r=this.getWidth(),s=e*r;return t===null?t=this.buffer.slice(s,s+r):(t.length<r&&(t=new Uint8ClampedArray(r)),t.set(this.buffer.slice(s,s+r))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,r,s){return super.crop(e,t,r,s),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),r=t.getContext("2d"),s=e*H.DEGREE_TO_RADIANS,n=this.canvas.width,i=this.canvas.height,o=Math.ceil(Math.abs(Math.cos(s))*n+Math.abs(Math.sin(s))*i),a=Math.ceil(Math.abs(Math.sin(s))*n+Math.abs(Math.cos(s))*i);return t.width=o,t.height=a,r.translate(o/2,a/2),r.rotate(s),r.drawImage(this.canvas,n/-2,i/-2),this.buffer=H.makeBufferFromCanvasImageData(t),this}invert(){return new re(this)}hightContrast(e=128){return new ce(this,e)}}H.DEGREE_TO_RADIANS=Math.PI/180,H.FRAME_INDEX=!0;class ze{get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}constructor(e,t=500,r){this.reader=e,this.timeBetweenScansMillis=t,this._hints=r,this._timeBetweenDecodingAttempts=0}getMediaElement(e,t){const r=document.getElementById(e);if(!r)throw new J(`element with id '${e}' not found`);if(r.nodeName.toLowerCase()!==t.toLowerCase())throw new J(`element with id '${e}' must be an ${t} element`);return r}decodeFromImage(e,t){if(!e&&!t)throw new J("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromImageElement(e){if(!e)throw new J("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);let r;return this.imageElement=t,r=this.isImageLoaded(t)?this.decodeOnce(t,!1,!0):this._decodeOnLoadImage(t),r}decodeFromImageUrl(e){if(!e)throw new J("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const r=this._decodeOnLoadImage(t);return t.src=e,r}_decodeOnLoadImage(e){return new Promise((t,r)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,r),e.addEventListener("load",this.imageLoadedListener)})}isImageLoaded(e){return!!e.complete&&e.naturalWidth!==0}prepareImageElement(e){let t;return e===void 0&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}decodeOnce(e,t=!0,r=!0){const s=(n,i)=>{try{n(this.decode(e))}catch(o){if(t&&o instanceof _||(o instanceof we||o instanceof O)&&r)return setTimeout(s,this._timeBetweenDecodingAttempts,n,i);i(o)}};return new Promise((n,i)=>s(n,i))}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),r=new H(t),s=new p(r);return new le(s)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const t=this.getCaptureCanvas(e);let r;try{r=t.getContext("2d",{willReadFrequently:!0})}catch{r=t.getContext("2d")}this.captureCanvasContext=r}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}drawImageOnCanvas(e,t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight},r=this.captureCanvasContext){r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}decodeBitmap(e){try{return this.reader.decode(e,this._hints)}finally{this.reader.reset()}}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let r,s;return e!==void 0&&e instanceof HTMLImageElement&&(r=e.naturalWidth||e.width,s=e.naturalHeight||e.height),t.style.width=r+"px",t.style.height=s+"px",t.width=r,t.height=s,t}reset(){this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src="",this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}}class He extends ze{constructor(e=100){const t=new j;super(t,e),this.inProgressDecodes=0,this.qrReader=t}safeReset(){if(this.inProgressDecodes===0)try{this.qrReader.reset()}catch{}}decodeBitmap(e){if(!e)throw new _("Bitmap cannot be null");this.inProgressDecodes++;try{return this.qrReader.decode(e,this._hints)}catch(t){throw t}finally{this.inProgressDecodes--,setTimeout(()=>this.safeReset(),0)}}async decodeFromImageUrl(e){this.inProgressDecodes++;try{const t=document.createElement("img");return t.src=e,new Promise((r,s)=>{t.onload=()=>{try{const n=this.decode(t);r(n)}catch(n){s(n)}},t.onerror=()=>{s(new Error("Failed to load image"))}})}finally{this.inProgressDecodes--}}reset(){this.inProgressDecodes===0?super.reset():setTimeout(()=>{this.inProgressDecodes===0&&super.reset()},100)}}class Ve extends be{constructor(e=!1){super(),this.debug=e,this.validatorName="ZXing Data URL Validator",this.validator=new He}async validate(e,t,r=!1){this.debug=this.debug||r;const s=[{name:"Normal SVG",execute:async()=>{if(!e)throw new Error("No svg source");const n="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e),i=await this.validator.decodeFromImageUrl(n);if(!i.getText())throw new Error("No text found in normal QR code");return{isValid:!0,data:i.getText(),message:"Decoded successfully."}}},{name:"Inverted SVG",execute:async()=>{const n=await t();if(!n)throw new Error("Failed to get inverted SVG");const i="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(n),o=await this.validator.decodeFromImageUrl(i);if(!o.getText())throw new Error("No text found in inverted QR code");return{isValid:!0,isInverted:!0,data:o.getText(),message:"Decoded successfully (inverted)."}}}];for(const n of s)try{return this.log(`Trying ${n.name} decode...`),await n.execute()}catch(i){this.log(`${n.name} decode failed:`),this.log(i)}return{isValid:!1,message:"Failed to decode QR code after all attempts."}}}export{Ve as default};
